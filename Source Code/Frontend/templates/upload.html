{% extends "index.html" %}
{% block content %}

<div class="card shadow-sm p-4 mx-auto" style="max-width: 650px;">
  <h3 class="text-center">Bulk Heart Disease Prediction</h3>
  <p class="text-muted text-center">
    Upload CSV or Excel file with patient data
  </p>

  {% if not results %}
  <form method="POST" enctype="multipart/form-data">
    <div class="form-group">
      <input type="file" name="file" class="form-control" required>
    </div>

    <button class="btn btn-primary btn-block mt-3">
      Upload & Predict
    </button>
  </form>
  {% endif %}

  {% if results %}
  <div id="loader" class="text-center mt-4">
    <div class="spinner-border text-primary"></div>
    <p class="mt-2">Processing heart disease dataâ€¦ Please wait</p>
  </div>
  {% endif %}
</div>

{% if results %}

<div id="resultsSection" style="display:none;">
  <hr>

  <h4 class="mt-4 text-center">
    Heart Disease 
  </h4>

  <div class="table-responsive">
    <table class="table table-bordered table-striped table-hover">

      <thead class="table-light">
        <tr>
          {% for key in results[0].keys() %}
            {% if key != "Probability (%)" %}
              <th>{{ key }}</th>
            {% endif %}
          {% endfor %}
        </tr>
      </thead>

      <tbody>
        {% for row in results %}
        <tr>
          {% for key, value in row.items() %}
            {% if key != "Probability (%)" %}
              <td>{{ value }}</td>
            {% endif %}
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>

    </table>
  </div>
</div>

<!-- Loader 5 Seconds -->
<script>
  setTimeout(() => {
    document.getElementById("loader").style.display = "none";
    document.getElementById("resultsSection").style.display = "block";
  }, 5000);
</script>

{% endif %}

{% endblock %}

